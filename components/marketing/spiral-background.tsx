"use client";

import { useEffect, useRef } from "react";

const SPIRAL_ART = [
  "$&&                                                                             *&$$$$$$$$$$$$$$$$$$$$$$$$$^                  z$$$$$$$$$$$$$$$$$                 _$$$$$$$$$$$$$$$$$k  ",
  "                                                                                     b$$$$$$$$$$$$$$$$$$$$$$${                  M$$$$$$$$$$$$$$$$-                p$$$$$$$$$$$$$$$$$> ",
  "                                                                                         Q$$$$$$$$$$$$$$$$$$$$$h                 ~$$$$$$$$$$$$$$$${                0$$$$$$$$$$$$$$$$$ ",
  "                                                                                            [q$$$$$$$$$$$$$$$$$$$U                 a$$$$$$$$$$$$$$$(                $$$$$$$$$$$$$$$$$1",
  "                                                                                               [0$$$$$$$$$$$$$$$$$$x                J$$$$$$$$$$$$$$$:               _$$$$$$$$$$$$$$$$$",
  "                               rZZZW$$$$$$$$$$$$$$$$$$$$$$$$$$$$mZZ1                              _m$$$$$$$$$$$$$$$$$[               1$$$$$$$$$$$$$$$?               )$$$$$$$$$$$$$$$$",
  "                       pa#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$oa\\                         <$$$$$$$$$$$$$$$$8               ,$$$$$$$$$$$$$$$.              .o$$$$$$$$$$$$$$$",
  "                 BB$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$BB                       $$$$$$$$$$$$$$$$B               $$$$$$$$$$$$$$@               .$$$$$$$$$$$$$$$",
  "          :1$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$n\"                   X&$$$$$$$$$$$$$$U              *$$$$$$$$$$$$$%.              c$$$$$$$$$$$$$$",
  "      +@$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$Q<                 \"%$$$$$$$$$$$$$$,             0$$$$$$$$$$$$$#               $$$$$$$$$$$$$$",
  " .)&$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@?                {B$$$$$$$$$$$$$+             O$$$$$$$$$$$$$n              |$$$$$$$$$$$$$",
  "$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$mxxxxx\\`        ~xxxxxv$$$$$$$$$$$$$$$$$$$$$$$$$$$$$\\               l*$$$$$$$$$$$$#             c$$$$$$$$$$$$$              I$$$$$$$$$$$$$",
  "$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$))<                                   -)f$$$$$$$$$$$$$$$$$$$$$$@+              r$$$$$$$$$$$$$             a$$$$$$$$$$$$d              $$$$$$$$$$$$$",
  "$$$$$$$$$$$$$$$$$$$$$$$$$$$$Y_'                                                 +]$$$$$$$$$$$$$$$$$$$O             '#$$$$$$$$$$$$             Q$$$$$$$$$$$$l              $$$$$$$$$$$$",
  "$$$$$$$$$$$$$$$$$$$$$$$>:                                                            :O$$$$$$$$$$$$$$$$8             ^$$$$$$$$$$$$^           .$$$$$$$$$$$$$              Z$$$$$$$$$$$",
  "$$$$$$$$$$$$$$$$$@Q                                                                       B@$$$$$$$$$$$$$$1            B$$$$$$$$$$$1           ?$$$$$$$$$$$$)             O$$$$$$$$$$$",
  "$$$$$$$$$$$$$Mp                                                                              _o$$$$$$$$$$$$$;           j$$$$$$$$$$$J           ,$$$$$$$$$$$$'             $$$$$$$$$$$",
  "$$$$$$$$$$p                                   ~--w$$$$$$$$$$$$$$$$$$$$$h---                     {#$$$$$$$$$$$$;           $$$$$$$$$$$_           m$$$$$$$$$$$J             h$$$$$$$$$$",
  "$$$$$$$X                               |\\W$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$o\\}                 X$$$$$$$$$$$a           #$$$$$$$$$$>           $$$$$$$$$$$$             t$$$$$$$$$$",
  "$$$$t.                           ^ua$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$u|              (*$$$$$$$$$$Q          U$$$$$$$$$$_          f$$$$$$$$$$$u            )$$$$$$$$$$",
  "${^                          L8$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$pu            !@$$$$$$$$$#          c$$$$$$$$$B           $$$$$$$$$$$W             $$$$$$$$$$",
  "                         d8$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$&c           ^m$$$$$$$$$m         _$$$$$$$$$w          !$$$$$$$$$$$>            $$$$$$$$$$",
  "                     \\&$$$$$$$$$$$$$$$$$$$$$$$$$$$$W\"\"^                    .\"\"v$$$$$$$$$$$$$$$$@x          '$$$$$$$$$%         p$$$$$$$$$'          #$$$$$$$$$$>            @$$$$$$$$$",
  "                 '1$$$$$$$$$$$$$$$$$$$$$$$$8W'                                      ]8$$$$$$$$$$$$$-         p$$$$$$$$$         x$$$$$$$$$.         h$$$$$$$$$$$            !$$$$$$$$$",
  "              \"[$$$$$$$$$$$$$$$$$$$$$$#k                                                 k$$$$$$$$$$$i'        o$$$$$$$@!        @$$$$$$$$t          $$$$$$$$$$$            !$$$$$$$$$",
  "            [$$$$$$$$$$$$$$$$$$$$$$0                                                        |p$$$$$$$$$L        Q$$$$$$$$!       lB$$$$$$$$l         Y$$$$$$$$$$1           !$$$$$$$$$",
  "          w$$$$$$$$$$$$$$$$$$$$O{                       ]ttM$$$$$$$$$$$$$$$$$$bttl             \\d$$$$$$$$r       ;$$$$$$$$        r$$$$$$$$X         Y$$$$$$$$$$r           !$$$$$$$$$",
  "       ~$$$$$$$$$$$$$$$$$$$$0                     nX&$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$pf          \"/$$$$$$$$1      '$$$$$$$W^       Z$$$$$$$$          $$$$$$$$$$r           !$$$$$$$$$",
  "     Q$$$$$$$$$$$$$$$$$$$w                   ]O$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$*Y         u$$$$$$$J      '#$$$$$$@       I$$$$$$$$C         $$$$$$$$$$r           !$$$$$$$$$",
  "   M$$$$$$$$$$$$$$$$$$h!                  h$$$$$$$$$$$$$$$$$$$$$$$c!!!!!!!!!!!@$$$$$$$$$$$$$$h        I$$$$$$@       C$$$$$$(       j$$$$$$$*         $$$$$$$$$$r           !$$$$$$$$$",
  " %$$$$$$$$$$$$$$$$$$-.                0B$$$$$$$$$$$$$$$$$$''.                       'v$$$$$$$$$$n       &$$$$$$       $$$$$$$       )$$$$$$$$l        C$$$$$$$$$r           !$$$$$$$$$",
  "$$$$$$$$$$$$$$$$$8                 X$$$$$$$$$$$$$$$@M{                                    M@$$$$$$$'      %$$$$$:     l$$$$$$O       $$$$$$$$l        }$$$$$$$$$r           %$$$$$$$$$",
  "$$$$$$$$$$$$$$$%,               i$$$$$$$$$$$$$$$d?                 :~~~c@$$$$$t~~~           }$$$$$$m      o$$$$$[     .$$$$$$       ,$$$$$$$!        }$$$$$$$$$r           $$$$$$$$$$",
  "$$$$$$$$$$$$$w               ^1$$$$$$$$$$$$$@Z               11$$$$$$$$$$$$$$$$$$$$$$$t1        b$$$$$x     0$$$$$<     m$$$$$8      ,$$$$$$$$        }$$$$$$$$$r           $$$$$$$$$$",
  "$$$$$$$$$$$o                w$$$$$$$$$$$$$Z             ?r$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$Wr      j$$$$$     /$$$$$      $$$$$BI      h$$$$$$$        }$$$$$$$$$j          [$$$$$$$$$$",
  "$$$$$$$$$$!              ~W$$$$$$$$$$$$$}            x$$$$$$$$$$$$$$((,             {(L$$$$$$*Y     Y$$$$]    u$$$$o     f$$$$$~      b$$$$$$$        \\$$$$$$$$$-          t$$$$$$$$$$",
  "$$$$$$$$~               M$$$$$$$$$$$$$\"           f$$$$$$$$$$$$_I                        :1$$$$$w    +$$$${    f$$$$l    ]$$$$$k      b$$$$$$@        $$$$$$$$$$           o$$$$$$$$$$",
  "$$$$$$w               #$$$$$$$$$$$$n           !#$$$$$$$$$$-^           !***B$$$$$M***       ($$$$*    d$$$c   'B$$$$     $$$$$$      b$$$$$$$        $$$$$$$$$$           $$$$$$$$$$$",
  "$$$$$'              w$$$$$$$$$$$$*           w$$$$$$$$$@{          a$$$$$$$$$$$$$$$$$$$$$$o     @$$$L   @$$$     $$$$/    @$$$$$      b$$$$$$l        $$$$$$$$$>          Z$$$$$$$$$$$",
  "$$$n              \"$$$$$$$$$$$$M           |$$$$$$$$$o         w$$$$$$$$%o}            Xo@$$$w   lB$$8.  *$$@!   0$$$/    !$$$$$      b$$$$$$l       Y$$$$$$$$@i          q$$$$$$$$$$$",
  "$Bl              O$$$$$$$$$$$&'          ~$$$$$$$$$0        j$$$$$$$bx         ------i     '#$$U,  j$$$   M$$0   0$$$d    !$$$$$      b$$$$$$l       Y$$$$$$$$W           $$$$$$$$$$$$",
  "o              ^W$$$$$$$$$$$q          !$$$$$$$$$~       l8$$$$$$U\"      1p$$$$$$$$$$$$$$B|`  U$$}  }$$O  }$$$.   $$$$    !$$$$$     \"@$$$$$*        $$$$$$$$$           $$$$$$$$$$$$q",
  "              t$$$$$$$$$$$%,          o$$$$$$$$(        h$$$$$$r      u$$$$$%r+          r$$$)  Z$$  -$$\\  Q$$j   $$$$    !$$$$k     ,$$$$$$*       z$$$$$$$$b          ?$$$$$$$$$$$$~",
  "             M$$$$$$$$$$$q          i@$$$$$$$$\"       m$$$$$$_     ($$$$$\\:    lL*$$$$$$0f  >$@! i$B  p$p  )$$j   $$$$    *$$$$~     W$$$$$$       'M$$$$$$$$~          $$$$$$$$$$$$t ",
  "           ~$$$$$$$$$$$$r          J$$$$$$$$<       U$$$$$$1     k$$$$W:   `d$$$$<i     .<B$p ~$M !$L  $$^ )$$j   $$$/    $$$$%^     $$$$$$J       !$$$$$$$$x          c$$$$$$$$$$$a. ",
  "          x$$$$$$$$$$$$:         :B$$$$$$$$^       8$$$$$C     C$$$$Z    kB$$?'  YW$$$$$$%k'`$# bk U$  $$^ )$$j   $$$/   \\$$$$8     )$$$$$$`       $$$$$$$$$'          $$$$$$$$$$$$^  ",
  "         `$$$$$$$$$$$B          |$$$$$$$$%       ]$$$$$$[     B$$$B    r$$B   n$$%  '#$%%@' %,.$ $:<$. o$^ )$$t  0$$$    r$$$$     .$$$$$$[       j$$$$$$$$\"          a$$$$$$$$$$$n   ",
  "        -$$$$$$$$$$$8          I$$$$$$$$O       Q$$$$$%'    ,$$$$O   >$$%\"  ~$BC ;$d\"I|hkkp!*_omv[: $  $d  r$$   %$$-   ;$$$$Q     Z$$$$$$       >$$$$$$$$d          $$$$$$$$$$$$o    ",
  "       |$$$$$$$$$$$%          ?$$$$$$$$c       t$$$$$a     _$$$$|   n$$o   $$q ^%b )w'^\\0- ;I+zB\"v):U$ ;$p  $$i  Q$$#.   k$$$k     ?$$$$$8.       $$$$$$$$a          |$$$$$$$$$$$%     ",
  "      }$$$$$$$$$$$o          +$$$$$$$$\\       O$$$$$$     r$$$$?   m$$o   $$u f$Y Lx1ur t{z i Bm:W^p).*%  b$M  _$$$    @$$$$     <$$$$$$[      ;$$$$$$$$$          ]$$$$$$$$$$$o      ",
  "     `$$$$$$$$$$$$          ]$$$$$$$$*       w$$$$$%,    ($$$$/   w$$@: :%$L  $p LU:$v|*><n)u c:v M( $$. &$d  [$$$_   O$$$M`    ?$$$$$$+       @$$$$$$$B:          $$$$$$$$$$$$       ",
  "    !@$$$$$$$$$$$;          $$$$$$$$b       \"$$$$$$      $$$$m   l$$$   d$$  p$  $ aiv\"8O|~Y00[\"O*'/$? {$$v  c$$$,   b$$$$      $$$$$$>       o$$$$$$$B          >@$$$$$$$$$$$;       ",
  "    $$$$$$$$$$$$-         .o$$$$$$$$       _$$$$$$C     Q$$$$    $$$O   $$) ^$z &$ Q>]m!]nOliii` hBr `%$k   h$$d   :B$$$@     `$$$$$$'      ,%$$$$$$$@          /$$$$$$$$$$$&^        ",
  "   J$$$$$$$$$$$a          8$$$$$$$$f       %$$$$$$      $$$$f   \\$$$|  j$$) ^$x W$ :$.]8'Bk `````  J@$_.  Q$$$.   |$$$$`     %$$$$$$       >$$$$$$$$$.         q$$$$$$$$$$$$          ",
  "  b$$$$$$$$$$$%          1$$$$$$$$$       X$$$$$$)     8$$$$    /$$$   j$$! ^$$  $C w$^ BU  hWWBWWW   ^v$$$W    \"$$$$8     \"$$$$$$!       0$$$$$$$$q          b$$$$$$$$$$$&           ",
  " \"$$$$$$$$$$$$t          $$$$$$$$$!       $$$$$$$     ~$$$$$    $$$$   j$$) ^$$  L$~ /$~ {k$$<<<<<<O$$$$d`    J$$$$k:    ,$$$$$$#       `B$$$$$$$$t          $$$$$$$$$$$$p            ",
  " $$$$$$$$$$$$w          J$$$$$$$$#       ?$$$$$$,     {$$$$!    $$$$   j$$)  p$p  d$f !@$Z   ;LLLLLLx      {$$$$$0      k$$$$$Bl       \\$$$$$$$$B          -$$$$$$$$$$$$j             ",
  "1$$$$$$$$$$$$l          $$$$$$$$$        *$$$$$$,     $$$$$!    $$$$   j$$M  .$$x  z$@+  Z$$$rjI    lrrm$$$$$$u      -$$$$$$$1       '#$$$$$$$$)          X$$$$$$$$$$$$~             ;",
  "$$$$$$$$$$$$$          L$$$$$$$$W       ,8$$$$$b      $$$$$!    $$$$    $$$|  x$$m  }$$$i   |Y$$$$$$$$$$$$|_      _L$$$$$$#(       iw$$$$$$$$r          .@$$$$$$$$$$$b              c$",
  "$$$$$$$$$$$$           W$$$$$$$$Y       l$$$$$$b      $$$$$!    $$$$0   |$$M   /$$#   f$$$m:                   mB$$$$$$$f:       lB$$$$$$$$O           w$$$$$$$$$$$$!              d$$",
  "$$$$$$$$$$$Z          >$$$$$$$$$<       l$$$$$$b      $$$$$!    /$$$o   .W$$&   I$$@{   ,@$$$$ooj        mo#$$$$$$$$$x,        Q$$$$$$$$$$'          n$$$$$$$$$$$$C               B$$$",
  "$$$$$$$$$$$           &$$$$$$$$$        $$$$$$$b      $$$$$@    /$$$$     $$$@    $$$$m     z$$$$$$$$$$$$$$$$$$$$[          1@$$$$$$$$$v           !$$$$$$$$$$$$$               @$$$$$",
  "$$$$$$$$$$$           $$$$$$$$$$        $$$$$$$b      $$$$$$     $$$$B'   v$$$$,   ,B$$$@;         p******+             ,n$$$$$$$$$$8>           !$$$$$$$$$$$$@!              ,$$$$$$$",
  "$$$$$$$$$$t          ^$$$$$$$$$j        $$$$$$$b      a$$$$$f    l$$$$@    _$$$$]    \\k$$$$$ui                      ~\\$$$$$$$$$$$8w            j$$$$$$$$$$$$$r              'W$$$$$$$$",
  "$$$$$$$$$$t          r$$$$$$$$$}        $$$$$$$b      ~$$$$$U     o$$$$Z    'W$$$$+     x$$$$$$$$a(({       }((j@$$$$$$$$$$$$$BU            `M$$$$$$$$$$$$W/               L$$$$$$$$$$",
  "$$$$$$$$$$           r$$$$$$$$$}        $$$$$$$k      IB$$$$$      d$$$$k     w$$$$8,      \\p$$$$$$$$$$$$$$$$$$$$$$$$$$$$$Mr,             n$$$$$$$$$$$$$$_               n$$$$$$$$$$$$",
  "$$$$$$$$$$           r$$$$$$$$$}        $$$$$$$$,      8$$$$$m     '$$$$$b     \"%$$$$$r        -1B$$$$$$$$$$$$$$$$$$$X1                C$$$$$$$$$$$$$$d                |$$$$$$$$$$$$$$",
  "$$$$$$$$$$           r$$$$$$$$$}        [$$$$$$$,       $$$$$$_     ^$$$$$8      !$$$$$$ht             <~~~~~~<                    xo$$$$$$$$$$$$$$$[                b$$$$$$$$$$$$$$$$",
  "$$$$$$$$$!           v$$$$$$$$$}        l$$$$$$$$       Q$$$$$$-     .$$$$$$k      i$$$$$$$$M                                  OM$$$$$$$$$$$$$$$${`                M$$$$$$$$$$$$$$$$$$",
  "$$$$$$$$$!           J$$$$$$$$${        l$$$$$$$$)       $$$$$$$.      B$$$$$$.       %$$$$$$$$$$a`'                   '';$$$$$$$$$$$$$$$$$$$%\\                 )$$$$$$$$$$$$$$$$$$@\" ",
  "$$$$$$$$$!           r$$$$$$$$$$         *$$$$$$$j       ($$$$$$$       o$$$$$$k        .#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$h                  ^$$$$$$$$$$$$$$$$$$$%t   ",
  "$$$$$$$$$!           r$$$$$$$$$$         U$$$$$$$$;       w$$$$$$#'       %$$$$$$Mi         Lb$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$BO                   ^]$$$$$$$$$$$$$$$$$$$M      ",
  "$$$$$$$$$!           r$$$$$$$$$$          $$$$$$$$m       .*$$$$$$$i       Z$$$$$$$&/           -z%$$$$$$$$$$$$$$$$$$$$$$$$$$$$$Yz'                    ./$$$$$$$$$$$$$$$$$$$$J        ",
  "$$$$$$$$$!           r$$$$$$$$$$Y         X$$$$$$$$n        W$$$$$$$(       .*$$$$$$$$*                tttm$$$$$$$$$$$@ftt\\.                        \\k$$$$$$$$$$$$$$$$$$$$$_          ",
  "$$$$$$$$$!           r$$$$$$$$$$Y          $$$$$$$$Bl        @$$$$$$$Q        !$$$$$$$$$$a>                                                      0$$$$$$$$$$$$$$$$$$$$$$[             ",
  "$$$$$$$$$!            $$$$$$$$$$$          \\$$$$$$$$$        `@$$$$$$$${        !m$$$$$$$$$$%k                                              Ik$$$$$$$$$$$$$$$$$$$$$$$|.               ",
  "$$$$$$$$$!            $$$$$$$$$$$h         .$$$$$$$$$n         Z$$$$$$$$p         .J$$$$$$$$$$$$$8&                                    C8$$$$$$$$$$$$$$$$$$$$$$$$$,.                  ",
  "$$$$$$$$$d            >$$$$$$$$$$#          '$$$$$$$$$p         |$$$$$$$$$/           &$$$$$$$$$$$$$$$$$$$:\"\"\"             `\"\"\"j$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$W!                      ",
  "$$$$$$$$$$            >$$$$$$$$$$$!          w$$$$$$$$$B         :B$$$$$$$$$>            d$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$d;                         ^",
  "$$$$$$$$$$             W$$$$$$$$$$$           k$$$$$$$$$c          h$$$$$$$$$$L             (q$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$L^                           f@$",
  "$$$$$$$$$$-            r$$$$$$$$$$$f           $$$$$$$$$$d          !$$$$$$$$$$$xl              _v8$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@u]                             jM$$$$",
  "$$$$$$$$$$t             $$$$$$$$$$$$           ;B$$$$$$$$$%:          [$$$$$$$$$$$au                 .\\Q$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$Y\\1                               \"X$$$$$$$$",
  "$$$$$$$$$$h             J$$$$$$$$$$$w           \"$$$$$$$$$$$}           t$$$$$$$$$$$$a?                      ~---d$$$$$$$$$$$$$$|---i                                     m$$$$$$$$$$$",
  "$$$$$$$$$$$              $$$$$$$$$$$$a           ,$$$$$$$$$$$J            Q$$$$$$$$$$$$$#x                                                                           \"k&$$$$$$$$$$$$$$",
  "$$$$$$$$$$$O             )$$$$$$$$$$$$]           1$$$$$$$$$$$$l            $$$$$$$$$$$$$$$$%                                                                    !B@$$$$$$$$$$$$$$$$$$",
  "$$$$$$$$$$$w              $$$$$$$$$$$$$^           ^B$$$$$$$$$$$J             t$$$$$$$$$$$$$$$$$*;                                                         `:p$$$$$$$$$$$$$$$$$$$$$$$$",
  "$$$$$$$$$$$$              \"$$$$$$$$$$$$$             *$$$$$$$$$$$$1              W$$$$$$$$$$$$$$$$$$$%_;                                             ;_?$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$",
  "$$$$$$$$$$$$$              d$$$$$$$$$$$$M`            O$$$$$$$$$$$$&>              J&$$$$$$$$$$$$$$$$$$$$$$B))-                              I))($$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$",
  "$$$$$$$$$$$$$l              $$$$$$$$$$$$$$             j$$$$$$$$$$$$$W;               z@$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$@vxxxxxxxxxxY%$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$Q",
  "$$$$$$$$$$$$$w              x$$$$$$$$$$$$$d             ~$$$$$$$$$$$$$$h                 )$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$n[   ",
  "$$$$$$$$$$$$$$l              \\$$$$$$$$$$$$$W              [$$$$$$$$$$$$$$d                  Ij$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$}i       ",
  "$$$$$$$$$$$$$$z               8$$$$$$$$$$$$$%              \"$$$$$$$$$$$$$$$%                    ,-$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$w:.           ",
  "$$$$$$$$$$$$$$$'               @$$$$$$$$$$$$$$               _$$$$$$$$$$$$$$$$x                       wB@$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$BB]                  ",
  "$$$$$$$$$$$$$$$*'               $$$$$$$$$$$$$$$;               M$$$$$$$$$$$$$$$$$l                          \"aa$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$aa|                         ",
  "$$$$$$$$$$$$$$$$@               ?$$$$$$$$$$$$$$$1               [$$$$$$$$$$$$$$$$$$W`                                0ZZZa$$$$$$$$$$$$$$$$$$$$WZZZZf                                  ",
  "$$$$$$$$$$$$$$$$$|               :@$$$$$$$$$$$$$$%                r&$$$$$$$$$$$$$$$$$$0                                                                                               ",
  "1$$$$$$$$$$$$$$$$$                 $$$$$$$$$$$$$$$$x                I$$$$$$$$$$$$$$$$$$$$bj                                                                                           ",
  " $$$$$$$$$$$$$$$$$#                i$$$$$$$$$$$$$$$$w                 +$$$$$$$$$$$$$$$$$$$$$@Q                                                                                        ",
  " \"$$$$$$$$$$$$$$$$$b                `@$$$$$$$$$$$$$$$$/                 'W$$$$$$$$$$$$$$$$$$$$$$Mp^                                                                                   ",
  "  b$$$$$$$$$$$$$$$$$_                 m$$$$$$$$$$$$$$$$&                  '($$$$$$$$$$$$$$$$$$$$$$$$$&z                                                                          O&$$$",
];

const FILL_CHARS = ["$", "#", "@", "%", "&", "*", "+", "=", "~", "^", "0", "8", "B", "W", "M", "Z"];

export function SpiralBackground() {
  const canvasRef = useRef<HTMLCanvasElement>(null);

  useEffect(() => {
    const canvas = canvasRef.current;
    if (!canvas) return;

    const ctx = canvas.getContext("2d");
    if (!ctx) return;

    // Build positions for all non-space characters
    const charPositions: { row: number; col: number }[] = [];
    const maxCols = Math.max(...SPIRAL_ART.map((line) => line.length));
    const totalRows = SPIRAL_ART.length;

    for (let r = 0; r < totalRows; r++) {
      for (let c = 0; c < SPIRAL_ART[r].length; c++) {
        if (SPIRAL_ART[r][c] !== " ") {
          charPositions.push({ row: r, col: c });
        }
      }
    }

    // Pre-compute distance from center for each position (for wave animation)
    const centerRow = totalRows / 2;
    const centerCol = maxCols / 2;
    const distances = charPositions.map((p) => {
      const dr = (p.row - centerRow) / totalRows;
      const dc = (p.col - centerCol) / maxCols;
      return Math.sqrt(dr * dr + dc * dc);
    });

    const baseFontSize = 5;
    const baseCharWidth = baseFontSize * 0.6;
    const baseArtWidth = maxCols * baseCharWidth;
    const baseArtHeight = totalRows * baseFontSize * 1.15;

    let fontSize = baseFontSize;
    let lineHeight = baseFontSize * 1.15;
    let charWidth = baseCharWidth;

    const resize = () => {
      const parent = canvas.parentElement;
      if (!parent) return;
      canvas.width = parent.clientWidth;
      canvas.height = parent.clientHeight;

      const scaleX = canvas.width / baseArtWidth;
      const scaleY = canvas.height / baseArtHeight;
      const scale = Math.max(scaleX, scaleY) * 1.05;
      fontSize = baseFontSize * scale;
      lineHeight = fontSize * 1.15;
      charWidth = fontSize * 0.6;
    };

    resize();
    window.addEventListener("resize", resize);

    let animId: number;

    const draw = (time: number) => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.font = `${fontSize}px monospace`;
      ctx.textBaseline = "top";

      const artW = maxCols * charWidth;
      const artH = totalRows * lineHeight;
      const offsetX = (canvas.width - artW) / 2;
      const offsetY = (canvas.height - artH) / 2;

      // Slow time for smooth wave
      const t = time * 0.0008;

      for (let i = 0; i < charPositions.length; i++) {
        const pos = charPositions[i];
        const x = offsetX + pos.col * charWidth;
        const y = offsetY + pos.row * lineHeight;

        if (x < -charWidth || x > canvas.width || y < -lineHeight || y > canvas.height) continue;

        // Smooth wave: symbol index based on distance from center + time
        const wave = t + distances[i] * 8;
        const idx = Math.floor(Math.abs(Math.sin(wave) * FILL_CHARS.length)) % FILL_CHARS.length;

        // Brightness pulse based on a second wave
        const pulse = 0.05 + Math.sin(t * 1.3 + distances[i] * 5) * 0.015;
        ctx.fillStyle = `rgba(255, 255, 255, ${pulse})`;
        ctx.fillText(FILL_CHARS[idx], x, y);
      }

      animId = requestAnimationFrame(draw);
    };

    animId = requestAnimationFrame(draw);

    return () => {
      cancelAnimationFrame(animId);
      window.removeEventListener("resize", resize);
    };
  }, []);

  return (
    <canvas
      ref={canvasRef}
      className="pointer-events-none absolute inset-0 h-full w-full"
      aria-hidden="true"
    />
  );
}
